## 3D pose generation

This module contains scripts to generate 3D coordinates from 2D, using VideoPose3D. 
Script **process_data.py** allows to generate 3D coordinates basis on 2D coordinates.
This script basis on 2D coordinates generated by MMPose.
This script is intended only for single pose videos (from all poses generated by MMPose for input video, only best one for each frame is selected).

### Options
- *video-pose-3d-path* - Absolute path to VideoPose3D (if not set, by default is used this one, set in config.ini from main project directory)
- *output-directory* - Path to generated results output directory (default='./results/')
- *input-directory* - Path to input data **required**
- *frame-width* - Width of frame **required**
- *frame-height* - Height of frame **required**
- *generate-2D* - Generate 2D coordinates too (by default only 3D are generated)

VideoPose3D installation and configuration process is described here https://github.com/facebookresearch/VideoPose3D

### Examples

Example command:

```
python process_data.py \
    --video-pose-3d-path /workspace/human_action_recognition/VideoPose3D \
    --input-directory unprocessed/ntu_rgbd/ \
    --output-directory dataset \
    --frame-width 1920 \
    --frame-height 1080 \
    --generate-2D
```

As it was mentioned before, script uses 2D coordinates generated by MMPose. 
Structure of this file should be similar to this one generated by *run_hpe.py* script, which is loacted in module *hpe* of this project.

Example structure of input dataset to process:

```
dataset/
├─ ntu_rgbd/
│  ├─  video_001
│  |  ├─  video_001_pose_0.csv
│  |  ├─  video_001_pose_1.csv
│  |  ├─  video_002_pose_0.csv
│  |  ├─  video_002_pose_1.csv
│  |  ├─  video_002_pose_1.csv
```

**IMPORTANT**

In order to use 3D pose generator script with poses generated by *hpe* module, directory structure needs to be changed - below bash commands can be used inside input dataset directory.
```
for i in $(find -type d -name bbox); do rm -rf $i; done
for i in $(find -type d -name pose_results); do mv $i/* $i/..; done
for i in $(find -type d -name pose_results); do rmdir $i; done
for i in $(find -type d -name "res152_coco_384x288"); do mv $i/csv/* "$i/.."; done
for i in $(find -type d -name csv); do rmdir $i; done
for i in $(find -type d -name res152_coco_384x288); do rmdir $i; done
```
